name: Atlas Auto Build
on:
  pull_request_review:
    types:
      - submitted
jobs:
  if_approved:
    if: github.event.review.state == 'approved'
    
    runs-on: 	
      - self-hosted
      - Windows
      - test
    steps:
     # - uses: actions/checkout@v4
       # with:
          # clean: true
          # fetch-depth: '0'
          # submodules: 'true'
     - name: Build
       run: |
            $uri = "https://api.github.com/repos/${{ github.repository }}/pulls/${{ github.event.pull_request.number }}/reviews "
            $headers = New-Object "System.Collections.Generic.Dictionary[[String],[String]]"
            $headers.Add("Content-Type", "application/json")
            $response = Invoke-RestMethod -Uri $uri -Headers $headers -Method GET
            echo $response | ConvertTo-Json | jq '.[] | select(.state=="APPROVED")' json
            echo "Auto build started"
            #Add code to run auto-build
    
    
